<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - GameSpace</title>
    
    <!-- Bootstrap CSS for Public Layout -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root{
          --bg:#eef3f8; --bg2:#ffffff; --ink:#1f2937; --muted:#64748b; --line:#e5e7eb;
          --surface:rgba(255,255,255,.75); --glass:rgba(255,255,255,.45);
          --accent:#7557ff; --accent-2:#34d2ff; --accent-3:#22c55e;
          --radius:18px; --radius-sm:12px; --shadow:0 18px 40px rgba(17,24,39,.12);
          --blur:14px;
          /* æ’è¡Œæ¦œé…è‰²ï¼ˆåƒè€ƒæª”é¢¨æ ¼ï¼‰ */
          --ok:#22c55e; --down:#ff6b6b; --flat:#9aa8bf;
          --gold:#FFD700; --silver:#C0C0C0; --bronze:#CD7F32;
          --goldA:rgba(255,215,0,.18); --silverA:rgba(192,192,192,.18); --bronzeA:rgba(205,127,50,.18);
        }
        body.dark{
          --bg:#0c111b; --bg2:#0a0f18; --ink:#e5edff; --muted:#9fb1c9; --line:#1e2b43;
          --surface:rgba(22,30,48,.65); --glass:rgba(18,24,39,.50);
          --shadow:0 18px 42px rgba(0,0,0,.35);
        }
        body.compact{ --radius:14px; --radius-sm:10px }
        *{box-sizing:border-box} html,body{height:100%}
        body{
          margin:0; color:var(--ink); font:16px/1.65 system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans TC","PingFang TC","Microsoft JhengHei",sans-serif;
          background:
            radial-gradient(900px 500px at -10% -10%, rgba(117,87,255,.10), transparent 60%),
            radial-gradient(800px 460px at 110% 10%, rgba(52,210,255,.10), transparent 50%),
            linear-gradient(180deg, var(--bg), var(--bg2));
        }
        a{color:inherit; text-decoration:none}
        .wrap{max-width:1380px; margin:0 auto; padding:0 16px}

        /* AppBar */
        header.appbar{position:sticky; top:0; z-index:50; backdrop-filter:saturate(140%) blur(var(--blur)); background:var(--glass); border-bottom:1px solid var(--line)}
        .bar{display:flex; align-items:center; gap:12px; padding:10px 0}
        .logo{display:flex; align-items:center; gap:10px; font-weight:900}
        .logo-badge{width:36px; height:36px; border-radius:10px; background:linear-gradient(135deg,var(--accent), var(--accent-2)); color:#fff; display:grid; place-items:center; box-shadow:var(--shadow)}
        .search{flex:1; display:flex; gap:8px; background:var(--surface); border:1px solid var(--line); border-radius:12px; padding:8px 10px}
        .search input{flex:1; background:transparent; border:0; outline:0; color:inherit}
        .main-nav{display:flex; gap:8px; flex-wrap:wrap}
        .pill{display:inline-flex; align-items:center; gap:6px; border:1px solid var(--line); background:var(--surface); padding:8px 12px; border-radius:999px; font-weight:700}
        .pill.on{background:linear-gradient(90deg,#3b82f6,#a78bfa); color:#fff; border-color:transparent}
        .top-actions{display:flex; gap:8px; align-items:center}
        .btn{border:1px solid var(--line); background:var(--surface); padding:8px 12px; border-radius:12px; cursor:pointer}
        .btn.primary{border:0; background:linear-gradient(135deg,var(--accent),#3b82f6); color:#fff; box-shadow:var(--shadow)}
        .btn.link{background:transparent; border:1px dashed var(--line)}
        .switch{display:flex; align-items:center; gap:6px; font-size:13px}
        .dot{width:16px; height:16px; border-radius:50%; border:1px solid var(--line); cursor:pointer}
        .dot.c1{background:#7557ff}.dot.c2{background:#34d2ff}.dot.c3{background:#22c55e}

        /* Tilesï¼ˆå½©è‰²çœ‹æ¿ï¼‰ */
        .tiles{padding:16px 0}
        .grid-tiles{display:grid; gap:12px; grid-template-columns:repeat(6, minmax(0,1fr))}
        @media (max-width:1100px){.grid-tiles{grid-template-columns:repeat(4, minmax(0,1fr))}}
        @media (max-width:740px){.grid-tiles{grid-template-columns:repeat(2, minmax(0,1fr))}}
        .tile{position:relative; min-height:120px; border-radius:16px; padding:14px; overflow:hidden; display:flex; flex-direction:column; justify-content:space-between; cursor:pointer; background:var(--glass); border:1px solid var(--line); backdrop-filter:blur(var(--blur)); transition:transform .16s ease, box-shadow .16s ease, filter .2s ease; box-shadow:var(--shadow)}
        .tile:hover{transform:translateY(-3px) scale(1.01)}
        .tile .name{font-weight:900}
        .tile .meta{color:var(--muted); font-size:12px}
        .mini{background:rgba(255,255,255,.65); padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid var(--line)}
        body.dark .mini{background:rgba(0,0,0,.25); color:#e5edff}
        /* å½©è‰²æ¼¸å±¤ï¼ˆçœ‹æ¿ï¼‰ */
        .tile.colorful:nth-child(1){background:linear-gradient(135deg,#4f46e5,#22d3ee)}
        .tile.colorful:nth-child(2){background:linear-gradient(135deg,#f43f5e,#f59e0b)}
        .tile.colorful:nth-child(3){background:linear-gradient(135deg,#22c55e,#16a34a)}
        .tile.colorful:nth-child(4){background:linear-gradient(135deg,#8b5cf6,#06b6d4)}
        .tile.colorful:nth-child(5){background:linear-gradient(135deg,#f97316,#ef4444)}
        .tile.colorful:nth-child(6){background:linear-gradient(135deg,#06b6d4,#3b82f6)}
        .tile.colorful .name,.tile.colorful .meta,.tile.colorful .mini{color:#fff}
        .tile.colorful .mini{background:rgba(255,255,255,.25); border-color:rgba(255,255,255,.35)}

        /* Hotï¼ˆæ©«å‘ï¼‰ */
        .hot{background:var(--glass); border:1px solid var(--line); border-radius:16px; padding:14px; backdrop-filter:blur(var(--blur)); box-shadow:var(--shadow)}
        .head{display:flex; align-items:center; gap:10px; margin-bottom:10px}
        .kicker{font-size:12px; letter-spacing:.12em; color:#6366f1}
        .scroller{display:flex; gap:12px; overflow:auto; scroll-snap-type:x mandatory; padding-bottom:6px}
        .card{min-width:280px; background:var(--surface); border:1px solid var(--line); border-radius:16px; padding:12px; scroll-snap-align:start; transition:transform .16s ease, box-shadow .16s ease}
        .card:hover{transform:translateY(-3px) scale(1.01); box-shadow:var(--shadow)}

        /* Main layout */
        main{margin:16px 0 28px}
        .layout{display:grid; grid-template-columns:1fr 360px; gap:16px}
        @media (max-width:980px){.layout{grid-template-columns:1fr}}

        .panel{background:var(--surface); border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow); padding:14px; backdrop-filter:blur(var(--blur))}
        .panel .hd{display:flex; align-items:center; gap:10px; margin-bottom:10px}
        .panel .title{font-weight:900}
        .seg{display:inline-flex; border:1px solid var(--line); border-radius:999px; overflow:hidden; margin-left:auto}
        .seg button{background:transparent; border:0; color:var(--muted); padding:6px 10px; cursor:pointer}
        .seg .on{background:#1f7ae0; color:#fff}

        .feed{display:grid; gap:10px}
        .row{display:grid; grid-template-columns:auto 1fr auto; gap:10px; align-items:center; border:1px solid var(--line); border-radius:14px; padding:10px; background:var(--bg2); transition:transform .16s ease, box-shadow .16s ease}
        .row:hover{transform:translateY(-3px) scale(1.01); box-shadow:var(--shadow)}
        .av{width:40px; height:40px; border-radius:12px; background:linear-gradient(135deg,#bae6fd,#e9d5ff); display:grid; place-items:center; font-weight:900; color:#334155}
        .meta{display:flex; gap:8px; flex-wrap:wrap; color:var(--muted); font-size:13px; margin-top:2px}
        .chip{border:1px solid var(--line); padding:2px 8px; border-radius:999px; background:var(--surface)}
        .ghost{border:1px solid var(--line); background:var(--surface); border-radius:10px; padding:6px 10px}

        /* ç½®é ‚å€ */
        .pinned{border:2px dashed #c4b5fd; background:rgba(196,181,253,.15); padding:10px; border-radius:12px}
        .pinned .row{background:transparent}

        /* å³å´ï¼šåŸæœ‰é»æ€§ï¼ˆä¿ç•™ï¼‰ã€å€‹åˆ¥å¡ç‰‡å¯å† sticky */
        .right{align-self:start; position:sticky; top:calc(50vh - 320px)}
        .stack{display:flex; flex-direction:column; gap:16px}

        /* è·‘é¦¬ç‡ˆï¼ˆåŠ é€Ÿï¼‰ */
        .ticker{position:relative; overflow:hidden; border:1px solid var(--line); background:var(--surface); border-radius:12px}
        .ticker .track{display:flex; gap:32px; padding:10px 12px; white-space:nowrap; animation:ticker 10s linear infinite}
        @keyframes ticker{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

        /* æ’è¡Œæ¦œï¼ˆé€šç”¨ï¼‰ */
        .list{display:flex; flex-direction:column; gap:8px}
        .rrow{position:relative; display:grid; grid-template-columns:40px 1fr auto; gap:10px; align-items:center; border:1px solid var(--line); background:var(--bg2); border-radius:12px; padding:10px; overflow:hidden}
        .rank{font-weight:900; text-align:center}
        .delta{text-align:right; min-width:64px; font-weight:800}
        .up{color:var(--ok)} .down{color:var(--down)} .flat{color:var(--flat)}
        .rrow.top::before{content:""; position:absolute; inset:0; pointer-events:none; z-index:0; opacity:.9; filter:blur(14px)}
        .rrow.top1::before{background:linear-gradient(90deg,var(--goldA),transparent 60%)}
        .rrow.top2::before{background:linear-gradient(90deg,var(--silverA),transparent 60%)}
        .rrow.top3::before{background:linear-gradient(90deg,var(--bronzeA),transparent 60%)}
        .rrow.top1 .rank, .rrow.top1 .title-2{color:var(--gold)}
        .rrow.top2 .rank, .rrow.top2 .title-2{color:var(--silver)}
        .rrow.top3 .rank, .rrow.top3 .title-2{color:var(--bronze)}
        .rrow > *{position:relative; z-index:1}

        .pulse{position:relative; overflow:hidden}
        .pulse::after{content:""; position:absolute; inset:-3px; border-radius:calc(var(--radius) + 6px); background:linear-gradient(90deg,var(--accent),var(--accent-2),var(--accent)); filter:blur(10px); opacity:.16; z-index:0; animation:pulseGlow 2.8s linear infinite}
        .pulse > *{position:relative; z-index:1}
        @keyframes pulseGlow{0%{transform:translateX(-20%)}50%{opacity:.26}100%{transform:translateX(20%)}}

        /* é¡åˆ¥æ’è¡Œç¶²æ ¼ï¼ˆåŠ å¯¬ï¼‰ */
        #cats2.grid-tiles{grid-template-columns:repeat(3,minmax(0,1fr))}
        @media (max-width:1100px){#cats2.grid-tiles{grid-template-columns:repeat(2,minmax(0,1fr))}}
        @media (max-width:740px){#cats2.grid-tiles{grid-template-columns:repeat(1,minmax(0,1fr))}}
        #cats2 .tile{min-height:auto}

        /* Modalï¼ˆç¾åŒ–ï¼‰ */
        .modal{position:fixed; inset:0; background:rgba(8,12,20,.85); display:none; align-items:center; justify-content:center; padding:24px; z-index:9999}
        .modal.show{display:flex}
        .modal .panel{position:relative; background:var(--surface); border:1px solid var(--line); border-radius:20px; max-width:980px; width:100%; max-height:86vh; overflow:auto; padding:18px 18px 22px; display:flex; flex-direction:column; gap:12px; backdrop-filter:blur(var(--blur))}
        .mh{display:flex; align-items:center; gap:10px; margin-bottom:6px}
        .mh .subtitle{color:var(--muted); font-size:13px}
        .closeX{position:absolute; top:12px; right:12px; border:1px solid var(--line); background:var(--surface); border-radius:50%; width:36px; height:36px; cursor:pointer}
        .modal .list .rrow{background:var(--surface)}
        .modal .list .rrow.top1::before,
        .modal .list .rrow.top2::before,
        .modal .list .rrow.top3::before{opacity:1; filter:blur(14px)}

        footer{color:var(--muted); text-align:center; padding:20px 0; border-top:1px solid var(--line)}

        /* ====== å³å´ Stickyï¼šæˆ‘çš„å²èŠå§†å¡ç‰‡ï¼ˆä½ æä¾›çš„æ¨£å¼ï¼Œå¾®èª¿é¡åé¿å…è¡çªï¼‰ ====== */
        .gs-right-sticky{ position: sticky; top:16px; }
        .gs-pet-card{
          font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
          background:#1f2430; color:#e9ecf1; border:1px solid #0006; border-radius:12px;
          box-shadow:0 8px 24px #0004, inset 0 1px 0 #fff1; padding:12px; width:100%;
        }
        .gs-pet-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; }
        .gs-pet-title{ font-weight:700; letter-spacing:.5px; }
        .gs-sub{ color:#aeb6d9; }
        .gs-coins{ background:#262d3d; border:1px solid #0006; padding:4px 8px; border-radius:999px; }
        .gs-pet-canvas-wrap{ display:flex; justify-content:center; margin:6px 0 10px; }
        #gs-pet-canvas{ image-rendering: pixelated; width:160px; height:160px; background:#9ee37d; border:1px solid #0006; border-radius:8px; }
        .gs-stats{ display:grid; grid-template-columns:1fr; gap:6px; margin-bottom:8px; }
        .gs-stat{ display:grid; grid-template-columns:auto 1fr auto; gap:8px; align-items:center; }
        .gs-bar{ height:10px; background:#2b3142; border:1px solid #0008; border-radius:6px; overflow:hidden; }
        .gs-bar i{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#6de38d,#35c47e); transition:width .25s; }
        .gs-bar.warn i{ background:linear-gradient(90deg,#ffd159,#ffba4b); }
        .gs-bar.bad i{ background:linear-gradient(90deg,#ff7b72,#ff5d6a); }
        .gs-actions{ display:grid; grid-template-columns:repeat(5,1fr); gap:6px; margin-bottom:8px; }
        .gs-actions button{ background:#2e3440; color:#fff; border:1px solid #0006; border-radius:10px; padding:8px 6px; cursor:pointer; }
        .gs-actions .gs-accent{ background:#5661ff; }
        .gs-log{ list-style:none; padding:8px; margin:0; max-height:120px; overflow:auto; background:#262d3d; border:1px solid #0006; border-radius:10px; font-size:12px; color:#c7d0ff; }
        .gs-log li{ margin:0 0 6px; }
        .gs-log .warn{ color:#ffe08a; }
        .gs-log .bad{ color:#ff9b93; }
    </style>
</head>
<body>
    <header class="appbar">
        <div class="wrap">
            <div class="bar">
                <a href="@Url.Action("Index", "Home", new { area = "MiniGame" })" class="logo">
                    <div class="logo-badge">G</div>
                    <span>GameSpace</span>
                </a>
                <div class="search">
                    <input type="text" placeholder="æœå°‹éŠæˆ²ã€æ–‡ç« ã€ç”¨æˆ¶..." />
                    <button class="btn">ğŸ”</button>
                </div>
                <nav class="main-nav">
                    <a href="@Url.Action("Index", "Home", new { area = "MiniGame" })" class="pill on">ğŸ  é¦–é </a>
                    <a href="@Url.Action("Index", "Pet", new { area = "MiniGame" })" class="pill">ğŸ¾ å¯µç‰©</a>
                    <a href="@Url.Action("Index", "MiniGame", new { area = "MiniGame" })" class="pill">ğŸ® éŠæˆ²</a>
                    <a href="@Url.Action("Index", "Shop", new { area = "MiniGame" })" class="pill">ğŸ›’ å•†åŸ</a>
                    <a href="@Url.Action("Index", "Forum", new { area = "MiniGame" })" class="pill">ğŸ’¬ è«–å£‡</a>
                    <a href="@Url.Action("Index", "Community", new { area = "MiniGame" })" class="pill">ğŸ‘¥ ç¤¾ç¾¤</a>
                </nav>
                <div class="top-actions">
                    <a href="@Url.Action("Index", "SignIn", new { area = "MiniGame" })" class="btn">ğŸ“… ç°½åˆ°</a>
                    <a href="@Url.Action("Index", "Wallet", new { area = "MiniGame" })" class="btn primary">ğŸ’° éŒ¢åŒ…</a>
                    <div class="switch">
                        <span>æ·±è‰²</span>
                        <div class="dot" onclick="toggleDark()"></div>
                    </div>
                    <div class="switch">
                        <span>ç·Šæ¹Š</span>
                        <div class="dot" onclick="toggleCompact()"></div>
                    </div>
                    <div class="switch">
                        <span>ä¸»è‰²</span>
                        <div class="dot c1" onclick="setColor(1)"></div>
                        <div class="dot c2" onclick="setColor(2)"></div>
                        <div class="dot c3" onclick="setColor(3)"></div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <main>
        <div class="wrap">
            @RenderBody()
        </div>
    </main>
    
    <footer>
        <div class="wrap">
            <p>&copy; 2025 GameSpace. ç‰ˆæ¬Šæ‰€æœ‰ã€‚</p>
        </div>
    </footer>
    
    <script>
        // ä¸»é¡Œåˆ‡æ›åŠŸèƒ½
        function toggleDark() {
            document.body.classList.toggle('dark');
            localStorage.setItem('darkMode', document.body.classList.contains('dark'));
        }
        
        function toggleCompact() {
            document.body.classList.toggle('compact');
            localStorage.setItem('compactMode', document.body.classList.contains('compact'));
        }
        
        function setColor(n) {
            document.documentElement.style.setProperty('--accent', n === 1 ? '#7557ff' : n === 2 ? '#34d2ff' : '#22c55e');
            localStorage.setItem('accentColor', n);
        }
        
        // è¼‰å…¥ä¿å­˜çš„è¨­å®š
        if (localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark');
        if (localStorage.getItem('compactMode') === 'true') document.body.classList.add('compact');
        const savedColor = localStorage.getItem('accentColor');
        if (savedColor) setColor(parseInt(savedColor));
        
        // å²èŠå§†å¯µç‰©å¡ç‰‡åŠŸèƒ½
        function initPetCard() {
            const canvas = document.getElementById('gs-pet-canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const size = 160;
            canvas.width = size;
            canvas.height = size;
            
            // ç¹ªè£½å²èŠå§†
            function drawSlime() {
                ctx.clearRect(0, 0, size, size);
                
                // èº«é«”
                ctx.fillStyle = '#9ee37d';
                ctx.beginPath();
                ctx.arc(size/2, size/2 + 10, 60, 0, Math.PI * 2);
                ctx.fill();
                
                // çœ¼ç›
                ctx.fillStyle = '#000';
                ctx.beginPath();
                ctx.arc(size/2 - 15, size/2 - 5, 8, 0, Math.PI * 2);
                ctx.arc(size/2 + 15, size/2 - 5, 8, 0, Math.PI * 2);
                ctx.fill();
                
                // å˜´å·´
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(size/2, size/2 + 15, 20, 0, Math.PI);
                ctx.stroke();
            }
            
            drawSlime();
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initPetCard);
    </script>
    
    <!-- Bootstrap JavaScript for Public Layout -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>